{% extends 'layout.jinja2' %}

{% block styles %}
    h1 {
		letter-spacing: 5px;
		font-size: 2rem;
	}
    p, a {
        font-size: 1.2rem;
    }
    .row:nth-of-type(even) {
        background-color: #ffffcc;
    }
    .row:nth-of-type(odd) {
        background-color: #f0e68c;
    }
{% endblock %}

{% block event %}onload="restore()"{% endblock %}

{% block header %}
	<div class="w3-display-container" style="display: none">
		<h1 class="w3-display-middle">{% block title %}Alberghi{% endblock %}</h1>
	</div>
{% endblock %}

{% block content %}
<div class="w3-sidebar w3-bar-block w3-sand w3-card" style="width: 25%">
  <h4 class="w3-bar-item  w3-orange">Alberghi</h4>
  {% for hotel in hotels %}
  	<button id="btn_{{ hotel.Hotel.id }}" class="w3-bar-item w3-button w3-hover-amber tablink" onclick='openHotel(event, "{{ hotel.Hotel.id }}")'>{{ hotel.Hotel.name }}</button>
  {% endfor %}
  {% if '_user_id' in session.keys() %}
    <div class="w3-container" style="margin-top: 40px">
      <a href="{{ url_for('dbms_bp.add_hotel') }}" class="w3-bar-item w3-center w3-ripple w3-button w3-hover-sand" title="Aggiungi hotel"><span class="material-symbols-outlined icon28">add</span></a>
    </div>
  {% endif %}
</div>

<div style="margin-left: 25%;">
{% for hotel in hotels %}
	<div id="{{ hotel.Hotel.id}}" class="w3-container albergo" style="display: none">
        {# titolo #}
	    <div class="w3-display-container" style="height: 200px;">
		    <h2 class="w3-display-middle">{{ hotel.Hotel.name }}</h2>
            {% if hotel.Hotel.photo %}
                <img src='{{ url_for("download_files", filename="images/"+hotel.Hotel.photo) }}' class="w3-display-left w3-margin-left w3-margin-top">
            {% else %}
                <img src='{{ url_for("download_files", filename="images/default.webp") }}' class="w3-display-left w3-margin-left w3-margin-top"> 
            {% endif %}
        </div>

        {# Display dati hotel #}
        <div style="margin-top: 100px; margin-right: 20%">
            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Indirizzo:</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align">{{ hotel.Hotel.address }}</p>
                </div>
            </div>

            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Citt√†:</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align">{{ hotel.Hotel.town }}</p>
                </div>
            </div>

            <div class="row w3-row w3-container">
                <div class="w3-col l4 m4 s5">
                    <p class="w3-left-align">Prenotazione:</p>
                </div>
                <div class="w3-col l5 m4 s5">
                {% if hotel.Hotel.reserved %}
                    <p class="w3-left-align"><span  class="material-symbols-outlined done">done</span></p>
                {% else %}
                    <p></p>
                {% endif %}
                </div>
            </div>

            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Check-in:</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align">{{ hotel.Hotel.check_in.strftime("%A %d %b") }}</p>
                </div>
            </div>

            {% if hotel.Hotel.check_out %}
            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Check-out:</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align">{{ hotel.Hotel.check_out.strftime("%A %d %b") }}</p>
                </div>
            </div>
            {% endif %}

            {% if hotel.Hotel.price %}         
            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Costo:</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align">&euro;{{ hotel.Hotel.price }}</p>
                </div>
            </div>
            {% endif %}

            {% if hotel.Hotel.lap %}
            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Tappa:</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align"><a href='{{ url_for("lap_bp.tappa", id=hotel.Hotel.lap.id) }}' target="_blank">{{ hotel.Hotel.lap.start }} - {{ hotel.Hotel.lap.destination }}</a></p>
                </div>
            </div>
            {% endif %}

            {% if hotel.Hotel.link %}
            <div class="row w3-row w3-container">
                <div class="w3-col l4 m5 s5">
                    <p class="w3-left-align">Vedilo su Booking.com</p>
                </div>
                <div class="w3-col l5 m5 s5">
                    <p class="w3-left-align"><a href="{{ hotel.Hotel.link }}" target="_blank" alt="pagine hotel su Booking.com">{{ hotel.Hotel.name }}</a></p>
                </div>
            </div>
            {% endif %}

            {% if '_user_id' in session.keys() %}
                <div class="w3-container w3-center" style="margin-top: 80px;">
                    <div class="w3-bar">
                        <a href="{{ url_for('dbms_bp.update_hotel', id=hotel.Hotel.id) }}" class="w3-bar-item w3-ripple w3-button w3-hover-sand" title="Modifica hotel"><span class="material-symbols-outlined icon28">edit</span></a>
                        <a href="{{ url_for('dbms_bp.delete_hotel', id=hotel.Hotel.id) }}" class="w3-bar-item w3-ripple w3-button w3-hover-sand" title="Cancella hotel"><span class="material-symbols-outlined icon28">delete</span></a>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
{% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script>
function restore() {
   let session = {{ session|tojson }};

   if (session['hotel_id']) {
    document.getElementById(session['hotel_id']).style.display = "block";
   }
   if (session['btn_id']) {
    document.getElementById(session['btn_id']).className += " w3-amber";
   }
}
</script>
{% endblock %}
